!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("krunch")):"function"==typeof define&&define.amd?define(["exports","krunch"],t):t((e=e||self).route={},e.krunch)}(this,function(e,t){"use strict";function n(e,t){void 0===t&&(t={});for(var n=function(e){for(var t=[],n=0;n<e.length;){var r=e[n];if("*"!==r&&"+"!==r&&"?"!==r)if("\\"!==r)if("{"!==r)if("}"!==r)if(":"!==r)if("("!==r)t.push({type:"CHAR",index:n,value:e[n++]});else{var o=1,i="";if("?"===e[a=n+1])throw new TypeError('Pattern cannot start with "?" at '+a);for(;a<e.length;)if("\\"!==e[a]){if(")"===e[a]){if(0==--o){a++;break}}else if("("===e[a]&&(o++,"?"!==e[a+1]))throw new TypeError("Capturing groups are not allowed at "+a);i+=e[a++]}else i+=e[a++]+e[a++];if(o)throw new TypeError("Unbalanced pattern at "+n);if(!i)throw new TypeError("Missing pattern at "+n);t.push({type:"PATTERN",index:n,value:i}),n=a}else{for(var s="",a=n+1;a<e.length;){var u=e.charCodeAt(a);if(!(u>=48&&u<=57||u>=65&&u<=90||u>=97&&u<=122||95===u))break;s+=e[a++]}if(!s)throw new TypeError("Missing parameter name at "+n);t.push({type:"NAME",index:n,value:s}),n=a}else t.push({type:"CLOSE",index:n,value:e[n++]});else t.push({type:"OPEN",index:n,value:e[n++]});else t.push({type:"ESCAPED_CHAR",index:n++,value:e[n++]});else t.push({type:"MODIFIER",index:n,value:e[n++]})}return t.push({type:"END",index:n,value:""}),t}(e),r=t.prefixes,i=void 0===r?"./":r,s="[^"+o(t.delimiter||"/#?")+"]+?",a=[],u=0,l=0,c="",f=function(e){if(l<n.length&&n[l].type===e)return n[l++].value},h=function(e){var t=f(e);if(void 0!==t)return t;var r=n[l],o=r.type,i=r.index;throw new TypeError("Unexpected "+o+" at "+i+", expected "+e)},d=function(){for(var e,t="";e=f("CHAR")||f("ESCAPED_CHAR");)t+=e;return t};l<n.length;){var p=f("CHAR"),m=f("NAME"),v=f("PATTERN");if(m||v){var g=p||"";-1===i.indexOf(g)&&(c+=g,g=""),c&&(a.push(c),c=""),a.push({name:m||u++,prefix:g,suffix:"",pattern:v||s,modifier:f("MODIFIER")||""})}else{var b=p||f("ESCAPED_CHAR");if(b)c+=b;else if(c&&(a.push(c),c=""),f("OPEN")){g=d();var y=f("NAME")||"",x=f("PATTERN")||"",w=d();h("CLOSE"),a.push({name:y||(x?u++:""),pattern:y&&!x?s:x,prefix:g,suffix:w,modifier:f("MODIFIER")||""})}else h("END")}}return a}function r(e,t){return function(e,t){void 0===t&&(t={});var n=i(t),r=t.encode,o=void 0===r?function(e){return e}:r,s=t.validate,a=void 0===s||s,u=e.map(function(e){if("object"==typeof e)return new RegExp("^(?:"+e.pattern+")$",n)});return function(t){for(var n="",r=0;r<e.length;r++){var i=e[r];if("string"!=typeof i){var s=t?t[i.name]:void 0,l="?"===i.modifier||"*"===i.modifier,c="*"===i.modifier||"+"===i.modifier;if(Array.isArray(s)){if(!c)throw new TypeError('Expected "'+i.name+'" to not repeat, but got an array');if(0===s.length){if(l)continue;throw new TypeError('Expected "'+i.name+'" to not be empty')}for(var f=0;f<s.length;f++){var h=o(s[f],i);if(a&&!u[r].test(h))throw new TypeError('Expected all "'+i.name+'" to match "'+i.pattern+'", but got "'+h+'"');n+=i.prefix+h+i.suffix}}else if("string"!=typeof s&&"number"!=typeof s){if(!l){var d=c?"an array":"a string";throw new TypeError('Expected "'+i.name+'" to be '+d)}}else{var h=o(String(s),i);if(a&&!u[r].test(h))throw new TypeError('Expected "'+i.name+'" to match "'+i.pattern+'", but got "'+h+'"');n+=i.prefix+h+i.suffix}}else n+=i}return n}}(n(e,t),t)}function o(e){return e.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function i(e){return e&&e.sensitive?"":"i"}function s(e,t,r){return function(e,t,n){void 0===n&&(n={});for(var r=n.strict,s=void 0!==r&&r,a=n.start,u=void 0===a||a,l=n.end,c=void 0===l||l,f=n.encode,h=void 0===f?function(e){return e}:f,d="["+o(n.endsWith||"")+"]|$",p="["+o(n.delimiter||"/#?")+"]",m=u?"^":"",v=0,g=e;v<g.length;v++){var b=g[v];if("string"==typeof b)m+=o(h(b));else{var y=o(h(b.prefix)),x=o(h(b.suffix));if(b.pattern)if(t&&t.push(b),y||x)if("+"===b.modifier||"*"===b.modifier){var w="*"===b.modifier?"?":"";m+="(?:"+y+"((?:"+b.pattern+")(?:"+x+y+"(?:"+b.pattern+"))*)"+x+")"+w}else m+="(?:"+y+"("+b.pattern+")"+x+")"+b.modifier;else m+="("+b.pattern+")"+b.modifier;else m+="(?:"+y+x+")"+b.modifier}}if(c)s||(m+=p+"?"),m+=n.endsWith?"(?="+d+")":"$";else{var E=e[e.length-1],O="string"==typeof E?p.indexOf(E[E.length-1])>-1:void 0===E;s||(m+="(?:"+p+"(?="+d+"))?"),O||(m+="(?="+p+"|"+d+")")}return new RegExp(m,i(n))}(n(e,r),t,r)}function a(e,t,n){return e instanceof RegExp?function(e,t){if(!t)return e;var n=e.source.match(/\((?!\?)/g);if(n)for(var r=0;r<n.length;r++)t.push({name:r,prefix:"",suffix:"",modifier:"",pattern:""});return e}(e,t):Array.isArray(e)?function(e,t,n){var r=e.map(function(e){return a(e,t,n).source});return new RegExp("(?:"+r.join("|")+")",i(n))}(e,t,n):s(e,t,n)}const u=Symbol();function l(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Promise((e,n)=>(function t(r,o){if(!r.length)return e(o);const[i,...s]=r,a="function"==typeof i?i(o):i,l=e=>t(s,e);if(null!=a){if(a===u)return;if(a.then)return a.then(l,n)}return Promise.resolve(l(a))})(t))}l.cancel=(()=>u),l.compose=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return l(...t.reverse())};const c=new Set,f=Symbol();function h(e,t){return e.forEach(n=>{n(t)===f&&e.delete(n)}),e}function d(e){throw new Error(e)}function p(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const[r,o,i,s]=[new Set,new Set,new Set,new Set(t)],a=function(e){const t=function*(){for(;;){const t=yield;yield l(t,...e)}}();return t.next(),t}(s),u=Object.create(a),c=e=>t=>e.add(t)&&u,f=e=>t=>e.delete(t)?u:d("Couldn't remove handler passed by reference");return Object.assign(u,{on:Object.freeze({value:c(r),error:c(o),end:c(i)}),off:Object.freeze({value:f(r),error:f(o),end:f(i)}),connect:c(s),push(e){const{value:t,done:n}=u.next(e);return n||t.then(e=>h(r,e),e=>h(o,e)),u},end:()=>(a.return(),h(i),[r,o,i,s].forEach(e=>e.clear()),u),fork:()=>p(...s),next(e){const t=a.next(e);return a.next(),t}})}p.install=function(e,t){return e&&"string"==typeof e||d("Please provide a name (as string) for your erre plugin"),t&&"function"==typeof t||d("Please provide a function for your erre plugin"),c.has(e)?d(`The ${e} is already part of the erre API, please provide a different name`):(p[e]=t,c.add(e)),p},p.install("cancel",l.cancel),p.install("off",()=>f);const m="undefined"!=typeof window,v=e=>e.replace(E.base,""),g=e=>t=>T(t,e)?t:p.cancel(),b=(e,t)=>(e.on.value(t.push),t.on.end(()=>{e.off.value(t.push)}),t),y=e=>{if(!E.silentErrors)throw new Error(e)},x=e=>(e=>"string"==typeof e)(e)?e:p.cancel(),w=p(x).on.error(y),E={base:"",silentErrors:!1,sensitive:!1,strict:!1,end:!0,start:!0,delimiter:"/#?",encode:void 0,endsWith:void 0,prefixes:"./"},O=e=>Object.assign({},E,{},e),N=(e,t,n)=>a(e,t,O(n)),A=(e,t,n)=>{const{base:r}=O(n),[,...o]=t.exec(e),i=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return m?new URL(...t):require("url").parse(...t)}(e,r);return i.params=o,i},T=(e,t)=>t.test(e),j=(e,t)=>[v,g(e),n=>A(n,e,t)];function M(e,t){const n=a(e,[],t),r=p(...j(n,t));return b(w,r).on.error(y)}const S=(e=>(w.on.value(t=>e=t),()=>e))(null);const C=(e,t,n)=>{const r=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((e,t)=>(function(){return e(t(...arguments))}))}(...j(e,n).reverse())(t);return r.params?r:null};var R={css:null,exports:{onBeforeMount(e){const t=S(),n=N(e.path,[],e);this.state={pathToRegexp:n,route:t&&T(t,n)?C(n,t,e):null},w.on.value(this.onBeforeRoute),this.stream=M(e.path,e).on.value(this.onRoute)},onBeforeRoute(e,t){T(e,this.state.pathToRegexp)||this.update({route:null})},onRoute(e){this.update({route:e})},onUnmounted(){w.off.value(this.onBeforeRoute),this.stream.end()}},template:function(e,t,n,r){return e('<template expr0="expr0"></template>',[{type:n.IF,evaluate:function(e){return e.state.route},redundantAttribute:"expr0",selector:"[expr0]",template:e('<slot expr1="expr1"></slot>',[{type:n.SLOT,attributes:[{type:t.ATTRIBUTE,name:"route",evaluate:function(e){return e.state.route}}],name:"default",redundantAttribute:"expr1",selector:"[expr1]"}])}])},name:"route-hoc"};function D(e){Array.from(e).forEach(k)}function k(e){const{parentNode:t}=e;e.remove?e.remove():t&&t.removeChild(e)}const P=2;var B=4;const I=0,L=2,$=3;const{indexOf:H}=[],U=(e,t,n,r,o,i)=>{const s="selectedIndex"in t;let a=s;for(;r<o;){const o=e(n[r],1);if(t.insertBefore(o,i),s&&a&&o.selected){a=!a;let{selectedIndex:e}=t;t.selectedIndex=e<0?r:H.call(t.querySelectorAll("option"),o)}r++}},_=(e,t)=>e==t,K=e=>e,F=(e,t,n,r,o,i,s)=>{const a=i-o;if(a<1)return-1;for(;n-t>=a;){let a=t,u=o;for(;a<n&&u<i&&s(e[a],r[u]);)a++,u++;if(u===i)return t;t=a+1}return-1},q=(e,t,n,r,o)=>n<r?e(t[n],0):0<n?e(t[n-1],-0).nextSibling:o,z=(e,t,n,r)=>{for(;n<r;)V(e(t[n++],-1))},W=(e,t,n)=>{let r=1,o=t;for(;r<o;){const t=(r+o)/2>>>0;n<e[t]?o=t:r=t+1}return r},G=(e,t,n,r,o,i,s,a,u,l,c,f,h)=>{((e,t,n,r,o,i,s,a,u)=>{const l=[],c=e.length;let f=s,h=0;for(;h<c;)switch(e[h++]){case 0:o++,f++;break;case 1:l.push(r[o]),U(t,n,r,o++,o,f<a?t(i[f],0):u);break;case-1:f++}for(h=0;h<c;)switch(e[h++]){case 0:s++;break;case-1:-1<l.indexOf(i[s])?s++:z(t,i,s++,s)}})(((e,t,n,r,o,i,s)=>{const a=n+i,u=[];let l,c,f,h,d,p,m;e:for(l=0;l<=a;l++){if(l>50)return null;for(m=l-1,d=l?u[l-1]:[0,0],p=u[l]=[],c=-l;c<=l;c+=2){for(f=(h=c===-l||c!==l&&d[m+c-1]<d[m+c+1]?d[m+c+1]:d[m+c-1]+1)-c;h<i&&f<n&&s(r[o+h],e[t+f]);)h++,f++;if(h===i&&f===n)break e;p[l+c]=h}}const v=Array(l/2+a/2);let g=v.length-1;for(l=u.length-1;l>=0;l--){for(;h>0&&f>0&&s(r[o+h-1],e[t+f-1]);)v[g--]=0,h--,f--;if(!l)break;m=l-1,d=l?u[l-1]:[0,0],(c=h-f)==-l||c!==l&&d[m+c-1]<d[m+c+1]?(f--,v[g--]=1):(h--,v[g--]=-1)}return v})(n,r,i,s,a,l,f)||((e,t,n,r,o,i,s,a)=>{let u=0,l=r<a?r:a;const c=Array(l++),f=Array(l);f[0]=-1;for(let e=1;e<l;e++)f[e]=s;const h=o.slice(i,s);for(let r=t;r<n;r++){const t=h.indexOf(e[r]);if(-1<t){const e=t+i;-1<(u=W(f,l,e))&&(f[u]=e,c[u]={newi:r,oldi:e,prev:c[u-1]})}}for(u=--l,--s;f[u]>s;)--u;l=a+r-u;const d=Array(l);let p=c[u];for(--n;p;){const{newi:e,oldi:t}=p;for(;n>e;)d[--l]=1,--n;for(;s>t;)d[--l]=-1,--s;d[--l]=0,--n,--s,p=p.prev}for(;n>=t;)d[--l]=1,--n;for(;s>=i;)d[--l]=-1,--s;return d})(n,r,o,i,s,a,u,l),e,t,n,r,s,a,c,h)},V=e=>(e.remove||function(){const{parentNode:e}=this;e&&e.removeChild(this)}).call(e);function J(e,t){return typeof e===t}function Q(e){const t=e.ownerSVGElement;return!!t||null===t}function X(e){return!ee(e.content)}function Y(e){return J(e,"function")}function Z(e){return!ee(e)&&J(e,"object")}function ee(e){return null==e}const te=Symbol("unmount"),ne=Object.seal({nodes:[],mount(e,t){return this.update(e,t)},update(e,t){const{placeholder:n,nodes:r,childrenMap:o}=this,i=e===te?null:this.evaluate(e),s=i?Array.from(i):[],a=n.parentNode,{newChildrenMap:u,batches:l,futureNodes:c}=function(e,t,n,r){const{condition:o,template:i,childrenMap:s,itemName:a,getKey:u,indexName:l,root:c,isTemplateTag:f}=r,h=new Map,d=[],p=[];return e.forEach((e,r)=>{const m=function(e,t){let{itemName:n,indexName:r,index:o,item:i}=t;return e[n]=i,r&&(e[r]=o),e}(Object.create(t),{itemName:a,indexName:l,index:r,item:e}),v=u?u(m):r,g=s.get(v);if(function(e,t){return!!e&&!1===Boolean(e(t))}(o,m))return;const b=g?g.template:i.clone(),y=g?b.el:c.cloneNode(),x=!g,w=f&&x?function(e){const t=e.dom.cloneNode(!0);return{avoidDOMInjection:!0,fragment:t,children:Array.from(t.childNodes)}}(b):{};if(x?d.push(()=>b.mount(y,m,n,w)):d.push(()=>b.update(m,n)),f){const e=w.children||b.children;p.push(...e)}else p.push(y);s.delete(v),h.set(v,{template:b,context:m,index:r})}),{newChildrenMap:h,batches:d,futureNodes:p}}(s,e,t,this);return((e,t,n,r)=>{r||(r={});const o=r.compare||_,i=r.node||K,s=null==r.before?null:i(r.before,0),a=t.length;let u=a,l=0,c=n.length,f=0;for(;l<u&&f<c&&o(t[l],n[f]);)l++,f++;for(;l<u&&f<c&&o(t[u-1],n[c-1]);)u--,c--;const h=l===u,d=f===c;if(h&&d)return n;if(h&&f<c)return U(i,e,n,f,c,q(i,t,l,a,s)),n;if(d&&l<u)return z(i,t,l,u),n;const p=u-l,m=c-f;let v=-1;if(p<m){if(-1<(v=F(n,f,c,t,l,u,o)))return U(i,e,n,f,v,i(t[l],0)),U(i,e,n,v+p,c,q(i,t,u,a,s)),n}else if(m<p&&-1<(v=F(t,l,u,n,f,c,o)))return z(i,t,l,v),z(i,t,v+m,u),n;p<2||m<2?(U(i,e,n,f,c,i(t[l],0)),z(i,t,l,u)):p===m&&((e,t,n,r,o,i)=>{for(;r<o&&i(n[r],e[t-1]);)r++,t--;return 0===t})(n,c,t,l,u,o)?U(i,e,n,f,c,q(i,t,u,a,s)):G(i,e,n,f,c,m,t,l,u,p,a,o,s)})(a,r,c,{before:n,node:re(Array.from(o.values()),t)}),l.forEach(e=>e()),this.childrenMap=u,this.nodes=c,this},unmount(e,t){return this.update(te,t),this}});function re(e,t){return(n,r)=>{if(r<0){const n=e.pop();if(n){const{template:e,context:r}=n;e.unmount(r,t,null)}}return n}}const oe=Object.seal({mount(e,t){return this.update(e,t)},update(e,t){const n=!!this.evaluate(e),r=!this.value&&n,o=this.value&&!n,i=()=>{const n=this.node.cloneNode();this.placeholder.parentNode.insertBefore(n,this.placeholder),this.template=this.template.clone(),this.template.mount(n,e,t)};switch(!0){case r:i();break;case o:this.unmount(e);break;default:n&&this.template.update(e,t)}return this.value=n,this},unmount(e,t){return this.template.unmount(e,t,!0),this}});const ie="removeAttribute",se="setAttribute",ae="undefined"==typeof Element?{}:Element.prototype,ue=function(e){const t=new Map,n=n=>t.has(n)?t.get(n):t.set(n,e.call(this,n))&&t.get(n);return n.cache=t,n}(e=>ae.hasOwnProperty(e));function le(e,t,n,r){let{name:o}=t;if(!o)return r&&function(e,t,n){const r=t?Object.keys(t):[];Object.keys(n).filter(e=>!r.includes(e)).forEach(t=>e.removeAttribute(t))}(e,n,r),void(n&&function(e,t){Object.entries(t).forEach(t=>{let[n,r]=t;return le(e,{name:n},r)})}(e,n));!ue(o)&&(function(e){return J(e,"boolean")}(n)||Z(n)||Y(n))&&(e[o]=n),e[function(e){return ee(e)||!1===e||""===e||Z(e)||Y(e)?ie:se}(n)](o,function(e,t){return!0===t?e:t}(o,n))}const ce=/^on/;function fe(e){return ee(e)?"":e}const he=(e,t)=>{const n=e.childNodes[t];if(n.nodeType===Node.COMMENT_NODE){const t=document.createTextNode("");return e.replaceChild(t,n),t}return n};var de={[I]:le,1:function(e,t,n,r){let{name:o}=t;const i=o.replace(ce,"");r&&e.removeEventListener(i,r),n&&e.addEventListener(i,n,!1)},[L]:function(e,t,n){e.data=fe(n)},[$]:function(e,t,n){e.value=fe(n)}};const pe=Object.seal({mount(e){return this.value=this.evaluate(e),me(this,this.value),this},update(e){const t=this.evaluate(e);return this.value!==t&&(me(this,t),this.value=t),this},unmount(){return 1===this.type&&me(this,null),this}});function me(e,t){return de[e.type](e.node,e,t,e.value)}function ve(e,t,n){if(!e||!e.length)return n;const r=e.map(e=>Object.assign({},e,{value:e.evaluate(t)}));return Object.assign(Object.create(n||null),function(e){return e.reduce((e,t)=>{const{value:n,type:r}=t;switch(!0){case!t.name&&r===I:return Object.assign({},e,{},n);case r===$:e.value=t.value;break;default:e[function(e){return e.replace(/-(\w)/g,(e,t)=>t.toUpperCase())}(t.name)]=t.value}return e},{})}(r))}const ge=Object.seal({attributes:[],getTemplateScope(e,t){return ve(this.attributes,e,t)},mount(e,t){const n=!!e.slots&&e.slots.find(e=>{let{id:t}=e;return t===this.name}),{parentNode:r}=this.node;return this.template=n&&Ae(n.html,n.bindings).createDOM(r),this.template&&(this.template.mount(this.node,this.getTemplateScope(e,t)),this.template.children=function e(t,n){void 0===n&&(n=[]);const r=t.firstChild;if(r)return t.parentNode.insertBefore(r,t),[r,...e(t)];return n}(this.node)),k(this.node),this},update(e,t){return this.template&&this.template.update(this.getTemplateScope(e,t)),this},unmount(e,t,n){return this.template&&this.template.unmount(this.getTemplateScope(e,t),null,n),this}});function be(e){return e.reduce((e,t)=>{let{bindings:n}=t;return e.concat(n)},[])}const ye=Object.seal({mount(e){return this.update(e)},update(e,t){const n=this.evaluate(e);var r,o,i;return n===this.name?this.tag.update(e):(this.unmount(e,t,!0),this.name=n,this.tag=(r=this.getComponent(n),o=this.slots,i=this.attributes,void 0===o&&(o=[]),void 0===i&&(i=[]),r?r({slots:o,attributes:i}):Ae(function(e){return e.reduce((e,t)=>e+t.html,"")}(o),[...be(o),{expressions:i.map(e=>Object.assign({type:I},e))}])),this.tag.mount(this.node,e)),this},unmount(e,t,n){return this.tag&&this.tag.unmount(n),this}});var xe={1:function(e,t){let{evaluate:n,template:r}=t;const o=e.parentNode,i=document.createTextNode("");return o.insertBefore(i,e),k(e),Object.assign({},oe,{node:e,evaluate:n,placeholder:i,template:r.createDOM(e)})},[P]:function(e,t){let{expressions:n}=t;return Object.assign({},(r=n.map(t=>(function(e,t){return Object.assign({},pe,{},t,{node:t.type===L?he(e,t.childNodeIndex):e})})(e,t)),["mount","update","unmount"].reduce((e,t)=>Object.assign({},e,{[t]:e=>r.map(n=>n[t](e))&&o}),{})));var r,o},0:function(e,t){let{evaluate:n,condition:r,itemName:o,indexName:i,getKey:s,template:a}=t;const u=document.createTextNode(""),l=e.parentNode,c=e.cloneNode();return l.insertBefore(u,e),k(e),Object.assign({},ne,{childrenMap:new Map,node:e,root:c,condition:r,evaluate:n,isTemplateTag:X(c),template:a.createDOM(e),getKey:s,indexName:i,itemName:o,placeholder:u})},3:function(e,t){let{evaluate:n,getComponent:r,slots:o,attributes:i}=t;return Object.assign({},ye,{node:e,evaluate:n,slots:o,attributes:i,getComponent:r})},4:function(e,t){let{name:n,attributes:r}=t;return Object.assign({},ge,{attributes:r,node:e,name:n})}};function we(e,t){return e.map(e=>e.type===L?Object.assign({},e,{childNodeIndex:e.childNodeIndex+t}):e)}function Ee(e,t){return Q(e)?function(e,t){return t.ownerDocument.importNode((new window.DOMParser).parseFromString(`<svg xmlns="http://www.w3.org/2000/svg">${e}</svg>`,"application/xml").documentElement,!0)}(t,e):function(e,t){const n=X(t)?t:document.createElement("template");return n.innerHTML=e,n.content}(t,e)}function Oe(e,t){switch(!0){case Q(e):!function e(t,n){t.firstChild&&(n.appendChild(t.firstChild),e(t,n))}(t,e);break;case X(e):e.parentNode.replaceChild(t,e);break;default:e.appendChild(t)}}const Ne=Object.freeze({createDOM(e){return this.dom=this.dom||function(e,t){return t&&("string"==typeof t?Ee(e,t):t)}(e,this.html),this},mount(e,t,n,r){if(void 0===r&&(r={}),!e)throw new Error("Please provide DOM node to mount properly your template");this.el&&this.unmount(t);const{fragment:o,children:i,avoidDOMInjection:s}=r,{parentNode:a}=i?i[0]:e,u=X(e),l=u?Math.max(Array.from(a.children).indexOf(e),0):null;return this.isTemplateTag=u,this.createDOM(e),this.dom&&(this.fragment=o||this.dom.cloneNode(!0)),this.el=this.isTemplateTag?a:e,this.children=this.isTemplateTag?i||Array.from(this.fragment.childNodes):null,!s&&this.fragment&&Oe(e,this.fragment),this.bindings=this.bindingsData.map(e=>(function(e,t,n){const{selector:r,type:o,redundantAttribute:i,expressions:s}=t,a=r?e.querySelector(r):e;i&&a.removeAttribute(i);const u=s||[];return(xe[o]||xe[P])(a,Object.assign({},t,{expressions:n&&!r?we(u,n):u}))})(this.el,e,l)),this.bindings.forEach(e=>e.mount(t,n)),this},update(e,t){return this.bindings.forEach(n=>n.update(e,t)),this},unmount(e,t,n){if(this.el){switch(this.bindings.forEach(r=>r.unmount(e,t,n)),!0){case this.children&&null!==n:D(this.children);break;case!0===n:k(this.el);break;case null!==n:D(this.el.childNodes)}this.el=null}return this},clone(){return Object.assign({},this,{el:null})}});function Ae(e,t){return void 0===t&&(t=[]),Object.assign({},Ne,{html:e,bindingsData:t})}function Te(e){E.base=e}function je(e){return Array.isArray(e)?e:/^\[object (HTMLCollection|NodeList|Object)\]$/.test(Object.prototype.toString.call(e))&&"number"==typeof e.length?Array.from(e):[e]}const Me=e=>e.split(/\s/);function Se(e,t,n,r,o){e=je(e),Me(t).forEach(t=>{e.forEach(e=>e[r](t,n,o||!1))})}function Ce(e,t,n,r){return Se(e,t,n,"addEventListener",r),e}function Re(e,t,n,r){return Se(e,t,n,"removeEventListener",r),e}const De=e=>1===e.length?e[0]:e;function ke(e,t){return function(e,t,n){const r="string"==typeof t?[t]:t;return De(je(e).map(e=>De(r.map(t=>e[n](t)))))}(e,t,"hasAttribute")}const Pe="popstate",Be="click",Ie=/^.+?\/\/+[^\/]+/,Le=()=>"undefined"==typeof window?null:window,$e=()=>"undefined"==typeof document?null:document,He=()=>Le()&&history,Ue=()=>{const e=Le(),t=He();return e&&(t.location||e.location)},_e=()=>w.push(We(String(Ue().href))),Ke=e=>{const t=e.includes(E.base)?e:E.base+e,n=Ue(),r=He(),o=$e();t!==n.href&&r.pushState(null,o.title,t)},Fe=e=>e&&!qe(e)?Fe(e.parentNode):e,qe=e=>"A"===e.nodeName,ze=e=>!e||!qe(e)||ke(e,"download")||!ke(e,"href")||(e=>e.target&&"_self"!==e.target)(e.target)||(e=>-1===e.indexOf(Ue().href.match(Ie)[0]))(e.href),We=e=>e.replace(E.base,""),Ge=e=>{if((e=>e.which&&1!==e.which||e.metaKey||e.ctrlKey||e.shiftKey||e.defaultPrevented)(e))return;const t=Fe(e.target);if(ze(t)||(e=>e.split("#").length>1)(t.href)||!(e=>!E.base||e.includes(E.base))(t.href))return;const n=We(t.href);w.push(n),e.preventDefault()};function Ve(e){const t=Le(),n=e||$e();return t&&(Ce(t,Pe,_e),Ce(n,Be,Ge)),w.on.value(Ke),()=>{t&&(Re(t,Pe,_e),Re(n,Be,Ge)),w.off.value(Ke)}}let Je=!1;var Qe={css:null,exports:t.pure(({slots:e,attributes:t,props:n})=>{Je&&function(e){throw new Error(e)}("Multiple <router> components are not supported");const r=e=>t&&t.find(t=>t.name===e);return{slot:null,el:null,teardown:null,mount(e,t){const n=S(),r=()=>{this.createSlot(t),w.off.value(r)};Je=!0,this.el=e,this.teardown=Ve(this.root),this.setBase(t),n?this.createSlot(t):w.on.value(r),w.push(window.location.href)},createSlot(t){if(!e||!e.length)return;const n=r("onStarted");this.slot=Ae(null,[{type:B,name:"default"}]).mount(this.el,{slots:e},t),n&&n.evaluate(t)(S())},update(e){this.setBase(e),this.slot&&this.slot.update({},e)},unmount(...e){this.teardown(),Je=!1,this.slot&&this.slot.unmount(...e)},getBase(e){const t=window.location,n=r("base");return n?n.evaluate(e):`${t.protocol}//${t.host}`},setBase(e){Te(n?n.base:this.getBase(e))}}}),template:null,name:"router-hoc"};e.Route=R,e.Router=Qe,e.createURLStreamPipe=j,e.filterStrings=x,e.getCurrentRoute=S,e.initDomListeners=Ve,e.match=T,e.route=M,e.router=w,e.setBase=Te,e.toPath=((e,t,n)=>r(e,O(n))(t)),e.toRegexp=N,e.toURL=A,Object.defineProperty(e,"__esModule",{value:!0})});
